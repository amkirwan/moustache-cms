module Create

  def create_site(site='foobar', domain='example.com')
    @site = FactoryGirl.build(:site, :name => site, :subdomain => site, :default_domain => domain)
    @site.add_domain '127.0.0.1'
    @site.save
  end

  def create_user(hash)
    @user = FactoryGirl.create(:user, :site => @site, :username => hash[:user], :email => "#{hash[:user]}@example.com", :firstname => hash[:firstname], :lastname => hash[:lastname])
  end

  def create_layout(name='foobar')
    @layout = FactoryGirl.create(:layout, :name => name, :site => @site, :created_by => @user, :updated_by => @user)
  end  

  def create_page(title, status)
    FactoryGirl.create(:page, :site => @site,
                     :parent_id => @parent.id,
                     :layout => @layout,
                     :created_by => @user,
                     :updated_by => @user,
                     :editors => [@user],
                     :title => title,
                     :current_state => FactoryGirl.build(:current_state, :name => status),
                     :page_parts => [FactoryGirl.build(:page_part, :name => 'foobar')])

  end

  def create_child_page(title, status, parent)
    FactoryGirl.create(:page, :site => @site,
                     :parent_id => parent.id,
                     :layout => @layout,
                     :created_by => @user,
                     :updated_by => @user,
                     :editors => [@user],
                     :title => title,
                     :current_state => FactoryGirl.build(:current_state, :name => status),
                     :page_parts => [FactoryGirl.build(:page_part, :name => 'foobar')])

  end

  def create_homepage
    @parent = FactoryGirl.create(:page, :title => 'Homepage', :site => @site, :layout => @layout, :created_by => @user, :updated_by => @user)
  end

  def create_snippet(name)
    @snippet = FactoryGirl.create(:snippet, :name => name, :site => @site)
  end

  def create_article_collection(name)
    @article_collection = FactoryGirl.create(:article_collection, :name => name, :site => @site)
  end

  def create_article_collection_with_permalink_prefix(name)
    @article_collection = FactoryGirl.create(:article_collection, :name => name, :site => @site, :permalink_prefix => true)
  end

  def create_article_collection_without_permalink_prefix(name)
    @article_collection = FactoryGirl.create(:article_collection, :name => name, :site => @site, :permalink_prefix => false)
  end

  def create_article(title, article_collection)
    @article = FactoryGirl.create(:article, :article_collection => article_collection, :site => @site, :title => title, :slug => title)
  end

  def create_asset_collection(name)
    @asset_collection = FactoryGirl.create(:asset_collection, :name => name, :site => @site)
  end

  def create_author(props)
    @author = FactoryGirl.create(:author, :firstname => props[:firstname], :lastname => props[:lastname], :site => @site)
  end

  def create_theme_collection(props)
    @theme_collection = FactoryGirl.create(:theme_collection, :name => props[:name], :site => @site)
  end

  def create_theme_asset(filename, theme_collection_name)
    @theme_collection = ThemeCollection.where(name: theme_collection_name).first
    @theme_asset = FactoryGirl.build(:theme_asset, filename:  filename, site: @theme_collection.site, theme_collection: @theme_collection) 
    @theme_collection.theme_assets << @theme_asset
    @theme_collection.save
  end
end

World(Create)
